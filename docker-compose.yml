networks:
  sentiric-net:
    # Bu aƒüƒ±n dƒ±≈üarƒ±dan y√∂netildiƒüini belirtiyoruz.
    # docker network create ile bir kere olu≈üturulacak.
    name: sentiric-net
    external: true

services:
  # üó£Ô∏è TTS GATEWAY SERVICE
  tts-gateway-service:
    image: ghcr.io/sentiric/sentiric-tts-gateway-service:latest
    build:
      context: .
      dockerfile: Dockerfile
    container_name: sentiric-tts-gateway
    volumes:
      - ../sentiric-certificates:/sentiric-certificates:ro
    environment:
      - ENV=production
      - RUST_LOG=info,sentiric_tts_gateway_service=debug
      
      # Upstream Services (mTLS URLs)
      - TTS_COQUI_SERVICE_URL=https://tts-coqui-service:14031
      - TTS_MMS_SERVICE_URL=https://tts-mms-service:14061
      
      # Security (mTLS)
      - GRPC_TLS_CA_PATH=/sentiric-certificates/certs/ca.crt
      - TTS_GATEWAY_SERVICE_CERT_PATH=/sentiric-certificates/certs/tts-gateway-service.crt
      - TTS_GATEWAY_SERVICE_KEY_PATH=/sentiric-certificates/certs/tts-gateway-service.key
      
    ports:
      - "14010:14010" # HTTP Health
      - "14011:14011" # gRPC
      - "14012:14012" # Metrics
    networks:
      sentiric-net:
        # Sabit IP, diƒüer servislerin bu gateway'i bulmasƒ± i√ßin kritik
        ipv4_address: ${TTS_GATEWAY_SERVICE_IPV4_ADDRESS:-10.88.40.1}
    restart: always